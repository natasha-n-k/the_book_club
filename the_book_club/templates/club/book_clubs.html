{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="filter">
    <form action="{% url 'club:book_clubs' %}" method="GET">
        <label for="genre">Жанр:</label>
        <select name="genre" id="genre">
            <option value="">Все</option>
            <option value="Фантастика">Фантастика</option>
            <option value="Детектив">Детектив</option>
            <option value="Драма">Драма</option>
            <option value="Ужас">Ужас</option>
            <option value="Фэнтези">Фэнтези</option>
            <option value="Психология">Психология</option>
            <option value="Нонфикшн">Нонфикшн</option>
            <option value="Поэзия">Поэзия</option>
            <option value="Классическая литература">Классическая литература</option>
            <option value="Современная проза">Современная проза</option>
            <option value="Биография">Биография</option>
            <option value="Пьеса">Пьеса</option>
        </select>

        <label for="theme">Тема:</label>
        <select name="theme" id="theme">
            <option value="">Все</option>
            <option value="Саморазвитие">Саморазвитие</option>
            <option value="Любовь">Любовь</option>
            <option value="Философия">Философия</option>
            <option value="Приключения">Приключения</option>
            <option value="Сильные женщины">Сильные женщины</option>
            <option value="Космос">Космос</option>
            <option value="Война">Война</option>
            <option value="Отношения">Отношения</option>
        </select>

        <button type="submit">Фильтровать</button>
    </form>
</div>

<div class="clubs-container">
    <div class="clubs-grid">
        {% for club in clubs %}
        <div class="clubs-cart">
            <div class="clubs-cart-container">
                <div class="clubs-cart-image">
                    <img src="{{ club.image.url }}" width="150" height="150">
                </div>
                <div class="clubs-cart-title">
                    <h2><a href="{% url 'club:club_detail' club.id %}">{{ club.name }}</a></h2>
                    <h4>{{ club.venue }}</h4>
                </div>
                <div class="clubs-cart-desc">
                    <p>{{ club.description }}</p>
                </div>
                <div class="clubs-book-title">
                    <h4>Сейчас читаем:</h4>
                </div>
                <div class="clubs-book-image">
                    {% if club.selected_book %}
                    <img src="{{ club.selected_book.image.url }}" alt="{{ club.selected_book.name }} cover" width="150">
                    {% else %}
                    <p>Книга не выбрана</p>
                    {% endif %}
                </div>
                <div class="clubs-cart-button">
                    {% if request.user in club.members.all %}
                    <form action="{% url 'club:club_detail' club.id %}">
                        {% csrf_token %}
                        <button type="submit">Вы участник клуба <br> перейти на страницу клуба</button>
                    </form>
                    {% else %}
                    <form action="{% url 'club:join_club' club.id %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="club_id" value="{{ club.id }}">
                        <button type="submit">Вступить</button>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}